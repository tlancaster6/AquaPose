---
phase: 14.1-fix-critical-mismatch-between-old-and-proposed-pipeline-structures
plan: "01"
subsystem: planning
tags: [roadmap, requirements, pipeline, stages]

# Dependency graph
requires:
  - phase: 14-golden-data-and-verification-framework
    provides: Completed Phase 14 which exposed the 7-stage vs 5-stage mismatch
provides:
  - ROADMAP.md and REQUIREMENTS.md aligned to 5-stage canonical pipeline model (Detection, Midline, Association, Tracking, Reconstruction)
  - Redundant inbox documents removed
affects:
  - 14.1-02-PLAN.md (engine code update follows this planning document cleanup)
  - 15-stage-migrations (foundation for Phase 15 plan structure)

# Tech tracking
tech-stack:
  added: []
  patterns:
    - "5-stage canonical pipeline: Detection -> Midline -> Association -> Tracking -> Reconstruction"
    - "Midline stage combines segmentation + skeletonization as segment-then-extract backend"
    - "Reconstruction stage combines triangulation + future curve optimizer as backends"

key-files:
  created: []
  modified:
    - .planning/ROADMAP.md
    - .planning/REQUIREMENTS.md
  deleted:
    - .planning/inbox/aquapose_pipeline_stage_structure.md
    - .planning/inbox/target_mapping.md
    - .planning/inbox/phase_15_partial_context.md

key-decisions:
  - "5 canonical stages replace 7: Detection, Midline (segment-then-extract), Association, Tracking, Reconstruction — matches guidebook Section 6"
  - "Midline stage subsumes segmentation (U-Net/SAM) and midline extraction (skeletonization+BFS) as a single segment-then-extract pipeline"
  - "Reconstruction stage subsumes triangulation backend now; curve optimizer is a planned second backend within the same stage"
  - "STG-01..05 replaces STG-01..07 — total v2.0 requirements drop from 24 to 22"

patterns-established:
  - "Guidebook is authoritative: planning docs must match guidebook Section 6 stage model, not the old script-based structure"

requirements-completed: []

# Metrics
duration: 2min
completed: 2026-02-26
---

# Phase 14.1 Plan 01: Update Planning Documents and Clean Up Inbox Summary

**ROADMAP.md and REQUIREMENTS.md corrected from 7-stage to 5-stage canonical pipeline model (Detection, Midline, Association, Tracking, Reconstruction) per guidebook, and 3 redundant inbox documents deleted**

## Performance

- **Duration:** ~2 min
- **Started:** 2026-02-26T00:13:36Z
- **Completed:** 2026-02-26T00:15:32Z
- **Tasks:** 2
- **Files modified:** 5 (2 updated, 3 deleted)

## Accomplishments

- Updated REQUIREMENTS.md: replaced STG-01..07 with 5 canonical stage requirements (STG-01..05), updated traceability table, corrected total coverage count from 24 to 22
- Updated ROADMAP.md: Phase 15 plan list changed from 7 plans to 5 with canonical stage names, requirements field updated to STG-01..STG-05, success criteria updated to reference 5 stages and model-based detection backend, progress table updated from 0/7 to 0/5
- Deleted 3 redundant inbox documents: `aquapose_pipeline_stage_structure.md`, `target_mapping.md`, `phase_15_partial_context.md`

## Task Commits

Each task was committed atomically:

1. **Task 1: Renumber STG requirements and update Phase 15 plans** - `428889b` (chore)
2. **Task 2: Delete redundant inbox documents** - `ac41419` (chore)

**Plan metadata:** (this summary commit)

## Files Created/Modified

- `.planning/REQUIREMENTS.md` - Replaced 7 STG requirements with 5 canonical stage requirements; updated traceability table and coverage count
- `.planning/ROADMAP.md` - Updated Phase 15 plan list, requirements field, success criteria, and progress table to reflect 5-stage model
- `.planning/inbox/aquapose_pipeline_stage_structure.md` - DELETED (redundant with guidebook Section 6)
- `.planning/inbox/target_mapping.md` - DELETED (redundant with guidebook migration strategy)
- `.planning/inbox/phase_15_partial_context.md` - DELETED (mismatch documentation no longer needed)

## Decisions Made

- Midline stage (STG-02) subsumes both U-Net/SAM segmentation and skeletonization+BFS pruning as a single segment-then-extract backend — matches guidebook's model where segmentation is not a standalone stage
- Reconstruction stage (STG-05) subsumes RANSAC triangulation + B-spline fitting now, with the curve optimizer as a planned future backend within the same stage — not a separate stage
- Total requirement count drops from 24 to 22 (removed 2 STG requirements)

## Deviations from Plan

None - plan executed exactly as written.

## Issues Encountered

- `git rm` on modified files required `-f` flag (files had local modifications from the context session commit); used `git rm -f` to force-remove tracked files, plain `rm` for the untracked `phase_15_partial_context.md`.

## User Setup Required

None - no external service configuration required.

## Next Phase Readiness

- Planning documents are now consistent with the guidebook's 5-stage model
- 14.1-02 can proceed to update engine code (PipelineContext fields, config, golden test harness) to match the same 5-stage model
- Phase 15 planning is unambiguous: exactly 5 plans, one per canonical stage

---
*Phase: 14.1-fix-critical-mismatch-between-old-and-proposed-pipeline-structures*
*Completed: 2026-02-26*

## Self-Check: PASSED

- REQUIREMENTS.md exists and has exactly 5 STG requirements (STG-01..05): VERIFIED
- REQUIREMENTS.md traceability table has STG-01..05 mapped to Phase 15: VERIFIED
- REQUIREMENTS.md coverage count is 22: VERIFIED
- ROADMAP.md Phase 15 has exactly 5 plans: VERIFIED
- ROADMAP.md Phase 15 requirements field says STG-01..STG-05: VERIFIED
- ROADMAP.md Progress table shows 0/5 for Phase 15: VERIFIED
- No STG-06 or STG-07 references in either file: VERIFIED
- Three inbox files deleted: VERIFIED
- Commits 428889b and ac41419 exist: VERIFIED
