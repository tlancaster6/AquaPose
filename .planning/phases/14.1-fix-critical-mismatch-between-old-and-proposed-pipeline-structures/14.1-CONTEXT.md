# Phase 14.1: Fix Critical Mismatch Between Old and Proposed Pipeline Structures - Context

**Gathered:** 2026-02-25
**Status:** Ready for planning

<domain>
## Phase Boundary

Align all active planning documents and Phase 13/14 code to the guidebook's canonical 5-stage pipeline model (Detection → Midline → Association → Tracking → Reconstruction). The guidebook (`.planning/alpha_refactor_guidebook.md`) is the single source of truth. This phase does NOT port any stages — it corrects the planning foundation so Phase 15 starts from a consistent, accurate model.

</domain>

<decisions>
## Implementation Decisions

### Source of Truth
- The alpha refactoring guidebook (`.planning/alpha_refactor_guidebook.md`) is the canonical pipeline definition
- All other documents must conform to its 5-stage model: Detection, Midline, Association, Tracking, Reconstruction
- No document or code should reference the old 7-stage model or the v1.0 stage ordering

### Phase 15 Roadmap Correction
- Replace 7-plan breakdown (detect, segment, midline, associate, triangulation, tracking, curve-opt) with 5 plans, one per guidebook stage
- 15-01: Detection stage, 15-02: Midline stage, 15-03: Cross-view association stage, 15-04: Tracking stage, 15-05: Reconstruction stage
- Clean 1:1 mapping between plans and stages

### Requirements Renumbering
- Renumber STG-01 through STG-07 to STG-01 through STG-05
- STG-01=Detection, STG-02=Midline, STG-03=Association, STG-04=Tracking, STG-05=Reconstruction
- Update all cross-references in ROADMAP.md and any phase docs that reference STG-* IDs

### Retroactive Code Fixes (Phases 13/14)
- Fix any Phase 13 engine code (PipelineContext fields, config stage names, Stage Protocol examples) that assumes the wrong stage structure
- Fix Phase 14 golden test assertions and harness code that reference incorrect stages
- Code and tests must match the guidebook's 5-stage model after this phase

### Inbox Document Cleanup
- Delete `aquapose_pipeline_stage_structure.md` — redundant with guidebook
- Delete `target_mapping.md` — redundant with guidebook
- Delete `phase_15_partial_context.md` — mismatch documentation no longer needed after fix
- The guidebook already has the canonical pipeline definition; inbox copies are redundant

### Claude's Discretion
- Exact wording of updated requirement descriptions
- Whether to update Phase 13/14 SUMMARY docs or leave them as historical record
- Order of operations for document vs code updates

</decisions>

<specifics>
## Specific Ideas

- "We built this milestone and completed phases 13 and 14 before realizing we were operating with the wrong model" — this is a correction phase, not a design phase
- The key structural differences from v1.0: association extracted from tracking into its own stage, segmentation merged into midline as a backend, tracking moves after association
- The guidebook's stage model was the intended target all along — the planning docs just hadn't caught up

</specifics>

<deferred>
## Deferred Ideas

None — discussion stayed within phase scope

</deferred>

---

*Phase: 14.1-fix-critical-mismatch-between-old-and-proposed-pipeline-structures*
*Context gathered: 2026-02-25*
