---
phase: 21-retrospective-prospective
plan: 02
type: execute
wave: 2
depends_on: [21-01]
files_modified:
  - .planning/phases/21-retrospective-prospective/21-PROSPECTIVE.md
autonomous: true
requirements: [CLI-01, CLI-02, CLI-03, CLI-04, CLI-05]
must_haves:
  truths:
    - "A forward-looking prospective document exists with candidate requirements for the next milestone"
    - "Stage-by-stage priority assessment identifies where accuracy gains are most impactful"
    - "Candidate requirements are ordered by bottleneck analysis with directional goals (not numeric targets)"
    - "The document is structured so /gsd:new-milestone can consume it directly as requirements input"
    - "Publication readiness drives the priority ordering"
  artifacts:
    - path: ".planning/phases/21-retrospective-prospective/21-PROSPECTIVE.md"
      provides: "Requirements seed for next milestone"
  key_links:
    - from: "21-PROSPECTIVE.md"
      to: "/gsd:new-milestone"
      via: "Structured as consumable requirements input"
    - from: "21-RETROSPECTIVE.md gaps section"
      to: "21-PROSPECTIVE.md candidate requirements"
      via: "Gaps flow into candidate requirements"
---

<objective>
Write the forward-looking prospective document seeding the next milestone's requirements.

Purpose: Define the direction for the next milestone (likely v2.1 or v3.0) based on gaps discovered in the retrospective and the primary thrust of end-to-end accuracy improvement. Structured for direct consumption by `/gsd:new-milestone`.

Output: `21-PROSPECTIVE.md`
</objective>

<execution_context>
@C:/Users/tucke/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/tucke/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/21-retrospective-prospective/21-CONTEXT.md
@.planning/phases/21-retrospective-prospective/21-RETROSPECTIVE.md
@.planning/phases/21-retrospective-prospective/21-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Write 21-PROSPECTIVE.md</name>
  <files>.planning/phases/21-retrospective-prospective/21-PROSPECTIVE.md</files>
  <action>
Create the forward-looking prospective document. This feeds directly into `/gsd:new-milestone` as requirements input.

**Read the retrospective first.** Read `21-RETROSPECTIVE.md` and its summary to understand what gaps were discovered. The gap flow is: retrospective discovers gaps -> gaps become candidate requirements here -> this document seeds `/gsd:new-milestone`.

**Primary thrust** (per CONTEXT.md): End-to-end accuracy improvement across all pipeline stages, driven by research publication needs.

**Document structure:**

1. **Milestone Vision** — What the next milestone should achieve and why. Frame around publication readiness — results need to be good enough to publish. Directional goals, not specific numeric targets (per CONTEXT.md — let target-setting happen during the next milestone's requirements phase).

2. **Bottleneck Analysis** — Stage-by-stage assessment of where accuracy is lost in the current pipeline. Order by impact — which stage improvements yield the largest end-to-end accuracy gain? Known bottlenecks to evaluate:
   - **Segmentation**: U-Net IoU 0.623 (well below 0.90 target) — noisy 2D masks propagate to all downstream stages
   - **Midline extraction**: Skeleton quality depends on mask quality; BFS pruning may discard valid branches
   - **Association**: RANSAC centroid clustering — robustness with overlapping/crossing fish
   - **Tracking**: Hungarian matching — track continuity through occlusions and crossing events
   - **Reconstruction**: RANSAC triangulation + B-spline fitting — dependent on upstream quality

   For each stage, assess: current quality level, dependency on upstream stages, potential for independent improvement, and expected downstream impact of improvement.

3. **Candidate Requirements** — Structured list of proposed requirements for the next milestone. Each requirement should have:
   - **ID**: Proposed requirement ID (e.g., SEG-01, MID-01, etc.)
   - **Title**: Brief description
   - **Priority**: Critical / High / Medium / Low (based on bottleneck analysis)
   - **Rationale**: Why this matters for publication readiness
   - **Phase suggestion**: Rough ordering of when to tackle this
   - **Depends on**: Other candidate requirements this depends on

   Candidate categories to consider:
   - Segmentation quality improvements (the known primary bottleneck)
   - Midline extraction improvements
   - Cross-view association robustness
   - Tracking continuity and accuracy
   - Reconstruction quality
   - Evaluation infrastructure (metrics, benchmarks, ground truth)
   - Any gaps surfaced in the retrospective

4. **Suggested Phase Structure** — Rough ordering of candidate requirements into phases. NOT a full roadmap — just enough structure for `/gsd:new-milestone` to work with. Consider:
   - Evaluation infrastructure should come early (measure before you optimize)
   - Upstream improvements before downstream (segmentation before reconstruction)
   - Independent improvements can parallelize

5. **Out of Scope** — Things that should NOT be in the next milestone. Keep focus tight. Examples:
   - Architecture changes (v2.0 architecture is solid)
   - New pipeline stages
   - GUI/web interface
   - Real-time processing

**Writing style:** Forward-looking, actionable. Each candidate requirement should be concrete enough for `/gsd:new-milestone` to turn into a real requirement, but use directional goals not numeric targets. Publication readiness is the key driver.

**Important:** This is a requirements SEED, not a final requirements document. The next milestone's discuss/plan cycle will refine these into actual requirements with acceptance criteria.
  </action>
  <verify>
    <automated>test -f .planning/phases/21-retrospective-prospective/21-PROSPECTIVE.md && wc -l .planning/phases/21-retrospective-prospective/21-PROSPECTIVE.md | awk '{print ($1 > 80) ? "PASS: " $1 " lines" : "FAIL: too short"}'</automated>
  </verify>
  <done>21-PROSPECTIVE.md exists with bottleneck analysis, prioritized candidate requirements, and suggested phase structure. Document is structured for direct consumption by /gsd:new-milestone.</done>
</task>

</tasks>

<verification>
1. `21-PROSPECTIVE.md` exists and contains bottleneck analysis, candidate requirements, and phase suggestions
2. Candidate requirements are ordered by priority based on bottleneck analysis
3. Publication readiness drives the priority ordering
4. Gaps from the retrospective are incorporated as candidate requirements
5. Document is structured for `/gsd:new-milestone` consumption (requirement IDs, priorities, dependencies)
</verification>

<success_criteria>
- 21-PROSPECTIVE.md provides a clear, actionable direction for the next milestone
- Stage-by-stage bottleneck analysis identifies segmentation as the primary bottleneck (known from U-Net IoU 0.623)
- Candidate requirements are prioritized and structured for /gsd:new-milestone consumption
- Out of scope is clearly defined to maintain focus
</success_criteria>

<output>
After completion, create `.planning/phases/21-retrospective-prospective/21-02-SUMMARY.md`
</output>
