---
phase: 20-post-refactor-loose-ends
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/aquapose/pipeline/
  - src/aquapose/initialization/
  - src/aquapose/mesh/
  - src/aquapose/utils/
  - src/aquapose/optimization/
  - tests/unit/pipeline/
  - tests/unit/initialization/
  - tests/unit/mesh/
  - scripts/legacy/diagnose_pipeline.py
  - scripts/legacy/diagnose_tracking.py
  - scripts/legacy/diagnose_triangulation.py
  - scripts/legacy/per_camera_spline_overlay.py
  - pyproject.toml
autonomous: true
requirements: [REMEDIATE]

must_haves:
  truths:
    - "No dead modules exist in src/aquapose/"
    - "No orphaned test directories exist for deleted modules"
    - "No legacy scripts that depend on deleted modules remain"
    - "Unit test suite still passes after deletions"
  artifacts:
    - path: "src/aquapose/"
      provides: "Clean source tree with only active modules"
  key_links:
    - from: "tests/"
      to: "src/aquapose/"
      via: "no test imports from deleted modules"
      pattern: "aquapose\\.(pipeline|initialization|mesh|utils)"
---

<objective>
Delete all dead modules identified in the Phase 19 audit (AUD-008, AUD-010, AUD-011, AUD-019, AUD-020) and their orphaned tests and dependent legacy scripts.

Purpose: Remove 5 dead modules that have zero pipeline consumers, eliminating confusion about which code is live. Also removes the toxic pytorch3d import side-effect from mesh/__init__.py.

Output: Clean source tree with only active modules remaining. Legacy scripts that depend on dead modules are deleted.
</objective>

<execution_context>
@C:/Users/tucke/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/tucke/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/20-post-refactor-loose-ends/20-CONTEXT.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Delete dead modules, orphaned tests, and legacy scripts</name>
  <files>
    src/aquapose/pipeline/
    src/aquapose/initialization/
    src/aquapose/mesh/
    src/aquapose/utils/
    src/aquapose/optimization/
    tests/unit/pipeline/
    tests/unit/initialization/
    tests/unit/mesh/
    scripts/legacy/diagnose_pipeline.py
    scripts/legacy/diagnose_tracking.py
    scripts/legacy/diagnose_triangulation.py
    scripts/legacy/per_camera_spline_overlay.py
    pyproject.toml
  </files>
  <action>
    Delete the following dead modules entirely (all files including __init__.py and __pycache__):
    1. `src/aquapose/pipeline/` — v1.0 orchestrator API, fully replaced by engine/pipeline
    2. `src/aquapose/initialization/` — v1.0 cold-start init (keypoints.py, triangulator.py), not called by pipeline
    3. `src/aquapose/mesh/` — v1.0 parametric mesh model (builder.py, cross_section.py, profiles.py, spine.py, state.py), requires pytorch3d, not called by pipeline
    4. `src/aquapose/utils/` — empty stub with `__all__ = []` and zero imports
    5. `src/aquapose/optimization/` — stale directory with only __pycache__/ remaining

    Delete orphaned test directories:
    6. `tests/unit/pipeline/` — tests for dead pipeline module
    7. `tests/unit/initialization/` — tests for dead initialization module
    8. `tests/unit/mesh/` — tests for dead mesh module

    Delete legacy scripts that depend on dead modules:
    9. `scripts/legacy/diagnose_pipeline.py` — imports `aquapose.pipeline.stages`
    10. `scripts/legacy/diagnose_tracking.py` — imports `aquapose.pipeline.stages`
    11. `scripts/legacy/diagnose_triangulation.py` — imports `aquapose.pipeline.stages`
    12. `scripts/legacy/per_camera_spline_overlay.py` — imports `aquapose.pipeline.stages`

    Check `pyproject.toml` for any `pytorch3d` reference in optional dependencies. If present, remove it. (pytorch3d was only needed by mesh/builder.py which is now deleted.)

    Use `git rm -rf` for tracked files/dirs and `rm -rf` for untracked dirs (__pycache__, optimization/).

    After deletion, verify no remaining imports reference deleted modules:
    - `grep -r "aquapose.pipeline" src/ tests/` should return nothing (except possibly planning docs)
    - `grep -r "aquapose.initialization" src/ tests/` should return nothing
    - `grep -r "aquapose.mesh" src/ tests/` should return nothing
    - `grep -r "aquapose.utils" src/ tests/` should return nothing
  </action>
  <verify>
    <automated>cd C:/Users/tucke/PycharmProjects/AquaPose && hatch run test 2>&1 | tail -20</automated>
  </verify>
  <done>
    - All 5 dead modules deleted from src/aquapose/
    - All 3 orphaned test directories deleted from tests/unit/
    - All 4 legacy scripts deleted from scripts/legacy/
    - pytorch3d removed from pyproject.toml if present
    - No import references to deleted modules remain in src/ or tests/
    - Unit test suite passes (collection errors for mesh/initialization tests gone)
  </done>
</task>

</tasks>

<verification>
1. `ls src/aquapose/pipeline/ src/aquapose/initialization/ src/aquapose/mesh/ src/aquapose/utils/ 2>&1` returns "No such file or directory" for all
2. `ls tests/unit/pipeline/ tests/unit/initialization/ tests/unit/mesh/ 2>&1` returns "No such file or directory" for all
3. `hatch run test` passes — the 6 collection errors from pytorch3d are gone
4. `grep -r "from aquapose.pipeline" src/ tests/` returns no matches
</verification>

<success_criteria>
- Zero dead modules in src/aquapose/
- Unit test suite passes with no collection errors from deleted modules
- No dangling imports to deleted modules
</success_criteria>

<output>
After completion, create `.planning/phases/20-post-refactor-loose-ends/20-02-SUMMARY.md`
</output>
